<!--KaTeX-->
<link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"
    integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"
    integrity="sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja"
    crossorigin="anonymous"></script>
<!-- Mostly Generated by pandoc -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var mathElements = document.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
            var texText = mathElements[i].firstChild;
            if (mathElements[i].tagName == "SPAN") {
                katex.render(texText.data, mathElements[i], {
                    displayMode: mathElements[i].classList.contains('display'),
                    throwOnError: false,
                    macros: macros,
                    fleqn: false
                });
            }
        }

        // replace KaTeX colors with CSS variables so that we can control them in light/dark mode
        document.querySelectorAll(".mrel").forEach(element => {
            if (element.style.color == "blue") {
                element.style.color = "var(--katex-blue)"
            } else if (element.style.color == "red") {
                element.style.color = "var(--katex-red)"
            } else if (element.style.color == "purple") {
                element.style.color = "var(--katex-purple)"
            }
        })

        // replace ¤ characters in source code with '.diff-area' spans and add a '.diff' class to the 
        // corresponding pre element to adjust the style correctly.
        // Ideally this would be done at compile time, but that's more difficult and will not work for katex segments.
        document.querySelectorAll("pre.sourceCode").forEach(pre => {
            let html = pre.innerHTML

            if (!/¤/.test(html)) {
                // This code block is not a diff block
                return
            }

            let matchingClosing = false
            while (/¤/.test(html)) {
                if (!matchingClosing) {
                    html = html.replace(/¤/, "<span class='diff-area'>")
                } else {
                    html = html.replace(/¤/, "</span>")
                }

                matchingClosing = !matchingClosing
            }
            if (matchingClosing) {
                console.error("unmatched diff block in source code", pre)
                return
            }

            pre.innerHTML = html
            pre.classList.add("diff")
        })
    })
</script>